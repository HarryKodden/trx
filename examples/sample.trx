// TRX Sample - PERSON Entity CRUD Operations
// Demonstrates REST API implementation using TRX grammar

// Define the PERSON record type mapped to the database table
TYPE PERSON FROM TABLE person;

// Initialize database with sample data
PROCEDURE init_person_table() {
    EXEC SQL CREATE TABLE IF NOT EXISTS person (
        id INTEGER PRIMARY KEY,
        name VARCHAR(64) NOT NULL,
        age INTEGER,
        active BOOLEAN DEFAULT TRUE,
        salary DECIMAL(10,2)
    );

    // Insert sample data if table is empty
    EXEC SQL INSERT INTO person (id, name, age, active, salary) VALUES
        (1, 'Alice Johnson', 30, TRUE, 75000.00),
        (2, 'Bob Smith', 25, TRUE, 50000.00),
        (3, 'Charlie Brown', 35, FALSE, 60000.00);
}

// ============================================================================
// PERSON CRUD OPERATIONS - REST API ENDPOINTS
// ============================================================================

// GET /persons - Retrieve all persons
EXPORT METHOD GET FUNCTION persons() : INTEGER {
    RETURN 42;
}

EXPORT METHOD GET FUNCTION person/{id: INTEGER}() : INTEGER {
    RETURN id;
}

EXPORT METHOD POST FUNCTION test(x: INTEGER) : INTEGER {
    RETURN x;
}
